(function(n,t){return n.$sspjs=n.sspjs=t(),$sspjs})(window,function(){var n={contructor:n,user:null,run:function(n,t){var i=this;$(document).ready(function(){ExecuteOrDelayUntilScriptLoaded(function(){if(!_spPageContextInfo)throw"No SharePoint context available!";i.sp.initContext(t);i.config.cachePrefix=i._hash(_spPageContextInfo.webAbsoluteUrl);i.config.webAbsoluteUrl=_spPageContextInfo.webAbsoluteUrl+"/";i.config.siteRelativeUrl=_spPageContextInfo.siteServerRelativeUrl+(_spPageContextInfo.siteServerRelativeUrl!=="/"?"/":"");i.config.layoutsUrl=_spPageContextInfo.layoutsUrl+"/";i.config.imagesPath=i.config.webAbsoluteUrl+i.config.layoutsUrl+"images/";i.config.language=_spPageContextInfo.currentCultureName;i.config.languageUI=_spPageContextInfo.currentUICultureName;var u=_spPageContextInfo.webServerRelativeUrl+"/",r=i.sp.getCurrentUserAsync();r.done(function(t){i.user=t;i.logger.log("user: "+t.name);i._injectAndExecute(n)});r.fail(function(n,t){i.logger.log(t)})},"sp.js")})},sp:{$0:{created:new Date},$1:{getApiUrl:function(){return n.config.webAbsoluteUrl+"_api/"},ajax:function(n,t,i,r,u,f){r||(r="get");switch(r){case"upload":return $.ajax({url:n,method:"POST",data:u,processData:!1,headers:{Accept:"application/json; odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:t,error:i});case"add":return $.ajax({url:n,method:"POST",contentType:"application/json;odata=verbose",data:JSON.stringify(u),headers:{Accept:"application/json; odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val()},success:t,error:i});case"update":return $.ajax({url:n,method:"POST",contentType:"application/json;odata=verbose",data:JSON.stringify(u),headers:{Accept:"application/json; odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"MERGE","If-Match":f},success:t,error:i});case"delete":return $.ajax({url:n,method:"POST",headers:{Accept:"application/json; odata=verbose","X-RequestDigest":$("#__REQUESTDIGEST").val(),"X-HTTP-Method":"DELETE","If-Match":f},success:t,error:i});case"get":default:return $.ajax({url:n,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:t,error:i})}}},_context:null,_getSpContext:function(t,i){return(n.sp._context===null||i===!0)&&(t||(n.sp._context=SP.ClientContext.get_current()),n.sp._context=new SP.ClientContext(t)),n.sp._context},_getWeb:function(t){var i=n.sp._getSpContext(t);return i.get_web()},_getList:function(t){var i=n.sp._getWeb(t);return i.get_lists().getByTitle(t.listname)},_getItem:function(t){var i=n.sp._getList(t);return i.getItemById(t.id)},_executeAsync:function(t,i,r){var f=n.sp._getSpContext(),u;if(t)for(u=0;u<t.length;u++)f.load(t[u]);f.executeQueryAsync(i,r)},initContext:function(t){return n.sp._getSpContext(t)},getCurrentUserAsync:function(){var e="CURRENT_USER",t=new $.Deferred,r=n.cache.get(e);if(r&&r.login)return n.logger.log("Current user from cache: "+r.login),t.resolve(r),t.promise();var u=n.sp._getSpContext(),f=u.get_web(),i=f.get_currentUser();return u.load(i),u.load(f,"EffectiveBasePermissions"),u.executeQueryAsync(Function.createDelegate(n.sp,function(){currentUser={id:i.get_id(),name:i.get_title(),email:i.get_email(),login:i.get_loginName()};currentUser.readonly=f.get_effectiveBasePermissions().has(SP.PermissionKind.editListItems)?!1:!0;n.cache.set(e,currentUser);t.resolve(currentUser)}),Function.createDelegate(n.sp,function(n,i){currentUser=null;t.reject(n,i.get_message(),i)})),t.promise()},hasPermissionAsync:function(t){var i=new $.Deferred,r=n.sp._getSpContext(),u=r.get_web(),f=u.get_currentUser();return r.load(f),r.load(u,"EffectiveBasePermissions"),r.executeQueryAsync(Function.createDelegate(n.sp,function(){u.get_effectiveBasePermissions().has(t)?i.resolve(!0):i.resolve(!1)}),Function.createDelegate(n.sp,function(n,t){i.reject(n,t.get_message(),t)})),i.promise()},setWebPropertyAsync:function(t,i){var r=new $.Deferred,u=n.sp._getWeb(),f=u.get_allProperties();return f.set_item(t,i+""),u.update(),n.sp._executeAsync([u],function(n,t){r.resolve(t)},function(n,t){r.reject(n,t.get_message(),t)}),r.promise()},getWebPropertyAsync:function(t){var i=new $.Deferred,r=n.sp._getWeb(),u=r.get_allProperties();return n.sp._executeAsync([r,u],function(){var n=u.get_item(t);i.resolve(n)},function(n,t){i.reject(n,t)}),i.promise()},getWebPropertiesAsync:function(t){var i=new $.Deferred,r=n.sp._getWeb(),u=r.get_allProperties();return n.sp._executeAsync([r,u],function(){for(var f,e={},r=0;r<t.length;r++)try{f=u.get_item(t[r]);f!==undefined&&f!==null&&(e[t[r]]=f)}catch(o){n.logger.log(o)}i.resolve(e)},function(n,t){i.reject(n,t)}),i.promise()},getListFieldsAsync:function(t){var i=new $.Deferred,f="LIST_FIELDS_"+t,r=n.cache.get(f),e,u;return r&&r.length?(n.logger.log("Fields from cache: "+r.length),i.resolve(r),i.promise()):(e=n.sp._getList({listname:t}),u=e.get_fields(),n.sp._executeAsync([u],function(){for(var e=u.getEnumerator(),r=[],t;e.moveNext();)t=e.get_current(),t.get_hidden()!=!0&&r.push({internalName:t.get_internalName(),title:t.get_title(),type:t.get_fieldTypeKind()==0&&t.get_typeAsString()==="TaxonomyFieldType"?1e3:t.get_fieldTypeKind()});n.logger.log(r.length+" fields received.");n.cache.set(f,r);i.resolve(r)},function(n,t){i.reject(n,t.get_message(),t)}),i.promise())},getListItemsAsync:function(t,i,r,u){var e;u||(u=100);var o=new $.Deferred,f=new n.sp._getSpContext,h=f.get_web().get_lists().getByTitle(t),s=new SP.CamlQuery;return s.set_viewXml("<View><RowLimit>"+u+"<\/RowLimit><\/View>"),r&&s.set_viewXml(r),e=h.getItems(s),i!==undefined&&i!==null?(n.logger.log("requested fields: "+i.join(", ")),f.load(e,"Include("+i.join(", ")+")")):f.load(e),f.executeQueryAsync(Function.createDelegate(n.sp,function(){for(var t=[],i=e.getEnumerator(),r;i.moveNext();)r=i.get_current(),t.push(r);n.logger.log(t.length+" items received.");o.resolve(t)}),Function.createDelegate(n.sp,function(n,t){o.reject(n,t.get_message(),t)})),o.promise()},getListItemsAsObjectsAsync:function(t,i,r,u){var e;u||(u=100);var o=new $.Deferred,f=new n.sp._getSpContext,h=f.get_web().get_lists().getByTitle(t),s=new SP.CamlQuery;return s.set_viewXml("<View><RowLimit>"+u+"<\/RowLimit><\/View>"),r&&s.set_viewXml(r),e=h.getItems(s),i!==undefined&&i!==null?(n.logger.log("requested fields: "+i.join(", ")),f.load(e,"Include("+i.join(", ")+")")):(i=["ID"],f.load(e)),f.executeQueryAsync(Function.createDelegate(n.sp,function(){for(var r=[],f=e.getEnumerator(),s,u,t;f.moveNext();){for(s=f.get_current(),u={},t=0;t<i.length;t++)u[i[t]]=s.get_item(i[t]);r.push(u)}n.logger.log(r.length+" items received.");o.resolve(r)}),Function.createDelegate(n.sp,function(n,t){o.reject(n,t.get_message(),t)})),o.promise()},getListItemByIdAsync:function(t,i,r,u){r||(r=[]);var s,e=new $.Deferred,f=new n.sp._getSpContext,h=f.get_web().get_lists().getByTitle(t),o=h.getItemById(i);return u===!0&&(r=["File","FileSystemObjectType"]),r&&r.length>0?(r.splice(0,0,o),f.load.apply(f,r)):f.load(o),f.executeQueryAsync(function(){u===!0?(s=o.get_file(),e.resolve(s.get_serverRelativeUrl())):e.resolve(o)},function(n,t){e.reject(n,t.get_message(),t)}),e.promise()},getListItemByFileUrlAsync:function(){},addListItemAsync:function(t,i,r){var e=new $.Deferred,o=n.sp._getList({listname:t}),s=new SP.ListItemCreationInformation,u=o.addItem(s);for(var f in i)i[f]!==undefined&&i[f]!==null&&u.set_item(f,i[f]);return r&&$.isFunction(r)&&r(u),u.update(),n.sp._executeAsync([u],function(){e.resolve(u)},function(n,t){e.reject(n,t.get_message(),t)}),e.promise()},updateListItemAsync:function(t,i,r,u){var o=new $.Deferred,s=n.sp._getList({listname:t}),f=s.getItemById(i);for(var e in r)r[e]!==undefined&&r[e]!==null&&e!=="Id"&&f.set_item(e,r[e]);return u&&$.isFunction(u)&&u(f),f.update(),n.sp._executeAsync([f],function(){o.resolve(f)},function(n,t){o.reject(n,t.get_message(),t)}),o.promise()},deleteListItemByIdAsync:function(t,i){var r=new $.Deferred,u=new n.sp._getList({listname:t}),f=u.getItemById(i);return f.deleteObject(),n.sp._executeAsync(null,function(){r.resolve(i)},function(n,t){r.reject(n,t.get_message(),t)}),r.promise()},getUserByIdAsync:function(t){var r=new $.Deferred,f="USER"+t,u=n.cache.get(f),e,i;return u&&u.login?(n.logger.log("User from cache: "+u.login),r.resolve(u),r.promise()):(e=n.sp._getWeb(),i=e.getUserById(t),n.sp._executeAsync([i],function(){var t={id:i.get_id(),name:i.get_title(),email:i.get_email(),login:i.get_loginName()};n.cache.set(f,t);r.resolve(t)},function(n,t){r.reject(n,t.get_message(),t)}),r.promise())},getUserLink:function(t){return n.config.webAbsoluteUrl+n.config.layoutsUrl+"userdisp.aspx?ID="+t},loadUserDataAsync:function(t,i){var r=new $.Deferred,e="USER"+t,f=n.cache.get(e);if(f&&f.LargeImage)return n.logger.log("UserData from cache: "+t),r.resolve(f),r.promise();i||(i=["PreferredName","PictureURL"]);var u=n.sp._getSpContext(),s=new SP.UserProfiles.PeopleManager(u),h=i,o=new SP.UserProfiles.UserProfilePropertiesForUser(u,t,h);return userProfileProperties=s.getUserProfilePropertiesFor(o),u.load(o),u.executeQueryAsync(Function.createDelegate(n.sp,function(){for(var u={},t=0;t<i.length;t++)u[i[t]]=userProfileProperties[t];n.cache.set(e,u);r.resolve(u)}),Function.createDelegate(n.sp,function(n,t){r.reject(n,"can not load user data",t)})),r.promise()},uploadFileAsync:function(t,i,r,u){var f=new $.Deferred,e=n.sp,s=""+t+(u?"/"+u:""),o=n.sp._getFileBufferAsync(r.files[0]);return o.done(function(t){var i=n.sp._addFileToFolderAsync(r.value,s,t);i.done(function(t){var i=t.ListItemAllFields.__deferred.uri+"",r=n.sp.getListItemByFileUrlAsync(i);r.done(function(n){f.resolve(n,i)});r.fail(function(n,t,i){f.reject(n,t,i)})});i.fail(function(n,t,i){f.reject(e,"file can not be uploaded",{xhr:n,ajax:t,error:i})})}),o.fail(function(n){f.reject(e,"file can not be converted",n)}),f.promise()},getFileUrlAsync:function(t,i){var r=new $.Deferred,u=n.sp.getListItemByIdAsync(t,i,null,!0);return u.done(function(n){r.resolve(n)}),u.fail(function(n,t,i){r.reject(n,t,i)}),r.promise()},getFileHistoryAsync:function(t,i){var r=new $.Deferred,f=n.sp._getWeb(),u=f.getFileByServerRelativeUrl(i),e=u.get_listItemAllFields();return n.sp._executeAsync([f,u,e],function(){var t=u.get_versions();n.sp._executeAsync([t],function(){for(var n=[],i=t.getEnumerator(),u;i.moveNext();)u=i.get_current(),n.push(u);r.resolve(n)},function(n,t){r.reject(n,t.get_message(),t)})},function(n,t){r.reject(n,t.get_message(),t)}),r.promise()},_addFileToFolderAsync:function(t,i,r){return function(n,u){var f=new $.Deferred,e=t.split("\\"),o=e[e.length-1],s=u.getApiUrl()+"web/getfolderbyserverrelativeurl('"+i+"')/files/add(overwrite=true, url='"+o+"')";return u.ajax(s,f.resolve,f.reject,"upload",r),f.promise()}({},n.sp.$1)},_getFileBufferAsync:function(n){var t=$.Deferred(),i=new FileReader;return i.onloadend=function(n){t.resolve(n.target.result)},i.onerror=function(n){t.reject(n.target.error)},i.readAsArrayBuffer(n),t.promise()},item:function(){return function(n,t){return n={_default:{plain:!1,query:""},_resolve:function(n,t,i,r){return i!==!0?r===!0?t.resolve(n.d.results):t.resolve(n.d):t.resolve(n),t},getByUrlAsync:function(i,r){var u=new $.Deferred;return r=$.extend(n._default,r),t.ajax(i,function(t){n._resolve(t,u,r.plain,!1)},u.reject),u.promise()}}}({},n.sp.$1,n.sp)},lists:function(){return function(){}({},n.sp.$1,n.sp)},list:function(t){return function(n,i,r){return n={_default:{plain:!1,query:""},_resolve:function(t,i,r,u){return r!==!0?u===!0?i.resolve(t.d.results):(i.resolve(t.d),n.itemtype=t.d.__metadata.type):(i.resolve(t),n.itemtype=t.d.__metadata.type),i},listname:t,itemtype:"",init:function(){return n.getItemTypeAsync(),n},getItemTypeAsync:function(){var t=new $.Deferred,r=i.getApiUrl()+"web/lists/getbytitle('"+n.listname+"')?$select=ListItemEntityTypeFullName";return i.ajax(r,function(t){n.itemtype=t.d.ListItemEntityTypeFullName},t.reject),t.promise()},getItemAsync:function(t,r){var u=new $.Deferred,f;return r=$.extend(n._default,r),f=i.getApiUrl()+"web/lists/getbytitle('"+n.listname+"')/items("+t+")",i.ajax(f,function(t){n._resolve(t,u,r.plain)},u.reject),u.promise()},getItemsAsync:function(t){var r=new $.Deferred,u;return t=$.extend(n._default,t),u=i.getApiUrl()+"web/lists/getbytitle('"+n.listname+"')/items?"+t.query,i.ajax(u,function(i){n._resolve(i,r,t.plain,!0)},r.reject),r.promise()},getFieldsAsync:function(t){var r=new $.Deferred,u;return t=$.extend(n._default,t),u=i.getApiUrl()+"web/lists/getbytitle('"+n.listname+"')/fields?"+t.query,i.ajax(u,function(i){n._resolve(i,r,t.plain,!0)},r.reject),r.promise()},addAsync:function(t){var r=new $.Deferred,u;return t=$.extend({__metadata:{type:n.itemtype}},t),u=i.getApiUrl()+"web/lists/getbytitle('"+n.listname+"')/items",i.ajax(u,r.resolve,r.reject,"add",t),r.promise()},uploadAsync:function(t,i,u){var f=new $.Deferred,o=r,s,e;if(!t||t.length===0)throw"no input field provided.";return s=""+n.listname+(u?"/"+u:""),e=r._getFileBufferAsync(t[0].files[0]),e.done(function(n){var i=r._addFileToFolderAsync(t[0].value,s,n);i.done(function(n){var t=n.d.ListItemAllFields.__deferred.uri+"",i=r.item().getByUrlAsync(t);i.done(function(n){f.resolve(n,t)});i.fail(function(n,t,i){f.reject(n,t,i)})});i.fail(function(n,t,i){f.reject(o,"file can not be uploaded",{xhr:n,ajax:t,error:i})})}),e.fail(function(n){f.reject(o,"file can not be converted",n)}),f.promise()},updateAsync:function(t,r){var u=new $.Deferred,f;return r=$.extend({__metadata:{type:n.itemtype}},r),f=n.getItemAsync(t),f.done(function(n){var t=n.__metadata.uri,f=n.__metadata.etag;i.ajax(t,u.resolve,u.reject,"update",r,f)}),f.fail(u.reject),u.promise()},deleteAsync:function(t){var r=new $.Deferred,u=n.getItemAsync(t);return u.done(function(n){var t=n.__metadata.uri,u=n.__metadata.etag;i.ajax(t,r.resolve,r.reject,"delete",n,u)}),u.fail(r.reject),r.promise()}}}({},n.sp.$1,n.sp)}},resources:{"default":{},init:function(t){n.resources.default=t},add:function(t,i,r){n.resources[t]||(n.resources[t]={});n.resources[t][i]=r},text:function(t,i){var r,u=t;return i||(i=n.config.language),r=n.resources[i],r||(r=n.resources.default),r[t]!==undefined&&r[t]!==null&&(u=r[t]),u}},logger:{log:function(t){try{console&&console.log&&n.config.doLogging===!0&&console.log(t)}catch(i){}}},config:{doCache:!0,cacheExpires:5,doLogging:!1,cachePrefix:"0",webAbsoluteUrl:"",siteRelativeUrl:"/",layoutsUrl:"_layouts/15/",imagesPath:"",language:"en-US",languageUI:"en-US"},cache:{_setCookie:function(n,t){var i=new Date,r=JSON.stringify(t);i.setTime(i.getTime()+36e5);document.cookie=n+"="+r+";expires="+i.toUTCString()},_getCookie:function(n){var t=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)"),i=t?t[2]:null;return i?JSON.parse(i):null},_setSessionCache:function(n,t){var i=JSON.stringify(t);sessionStorage.setItem(n,i)},_getSessionCache:function(n){var t=sessionStorage.getItem(n);return t?JSON.parse(t):null},_clearSessionCache:function(){sessionStorage.clear()},set:function(t,i){t=n.config.cachePrefix+"_"+t;i={val:i,created:Date.now()};sessionStorage&&sessionStorage.setItem?n.cache._setSessionCache(t,i):n.cache._setCookie(t,i)},get:function(t){var i=null,r=null,u,f=Date.now();return n.config.doCache?(t=n.config.cachePrefix+"_"+t,i=sessionStorage&&sessionStorage.getItem?n.cache._getSessionCache(t):n.cache._getCookie(t),!i||!i.val)?null:(u=i.created,r=i.val,f-u>6e4*n.config.cacheExpires)?null:r:null},clear:function(){sessionStorage&&sessionStorage.setItem&&n.cache._clearSessionCache()}},notify:{show:function(n){SP.UI.Notify.addNotification(n,!1)},addStatus:function(n){n.color||(n.color="yellow");var t=SP.UI.Status.addStatus(n.title,n.message);return SP.UI.Status.setStatusPriColor(t,n.color),t},removeStatus:function(n){n&&SP.UI.Status.removeStatus(n)},removeAllStatus:function(){SP.UI.Status.removeAllStatus(!0)}},dialog:{openModalDialogAsync:function(t){var i=new $.Deferred,r=SP.UI.$create_DialogOptions();return r.url=t,r.dialogReturnValueCallback=Function.createDelegate(n.sp,function(n,t){n==SP.UI.DialogResult.OK?i.resolve(t):i.reject(t)}),SP.UI.ModalDialog.showModalDialog(r),i.promise()},closeModalDialog:function(n){window.frameElement.commitPopup(n)}},_hash:function(n){var t=0;if(n.length==0)return t;for(i=0;i<n.length;i++)char=n.charCodeAt(i),t=(t<<5)-t+char,t=t&t;return t},_getFunctionParameters:function(n){return n.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s))/mg,"").match(/^function\s*[^\(]*\(\s*([^\)]*)\)/m)[1].split(/,/)},_injectAndExecute:function(t){var arguments=[],i=n._getFunctionParameters(t);return arguments=n._getParameterMapping(i),t.apply(null,arguments)},_getParameterMapping:function(t){var u,r=[];for(i=0;i<t.length;i++)t[i]&&t[i].length>0?(u=t[i].substring(1),r.push(n[u])):r.push(null);return r}};return function(t){n.run(t)}});
//# sourceMappingURL=sspjs-1.1.5.min.js.map
